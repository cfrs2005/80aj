---
title: 140403 微信服务号查询用户信息demo
layout: post
permalink: /2806.html
categories:
  - Code
tags:
  - demo
  - 微信
  - 服务号
  - 用户信息
---
用来查询微信用户信息的，获取用户openid后后去更多相关信息。 define ( 'APP\_ID', 'wxccccf7a6gggg4e2' ); define ( 'APP\_SECRET', 'bc0ff2e74ebadddd0be31cad2c658a2' ); $token = get\_token (); $user\_array = array ( 'o\_asdhAHoIkccccccc\_dgFokI', 'asdasdasd-NeLQibjnbQ', 'deqweqweqweQlrRfxl87k6YKA', 'occccdee-elL8KPiVEeZwelNhmAY' ); $users = array (); foreach ( $user\_array as $user ) { $users [] = get\_user\_info ( $user, $token ); } function get\_token() { $url = "https://api.weixin.qq.com/cgi-bin/token?grant\_type=client\_credential&appid=" . APP\_ID . "&secret=" . APP\_SECRET; $data = json\_decode ( file\_get\_contents ( $url ), true ); if ($data ['access\_token']) { return $data ['access\_token']; } else { return "获取access\_token错误"; } } function get\_user\_info($openid, $token) { $url = "https://api.weixin.qq.com/cgi-bin/user/info?access\_token=" . $token . "&openid=" . $openid . "&lang=zh\_CN"; $data = json\_decode ( file\_get\_contents ( $url ), true ); if ($data) { return $data; } else { echo "获取信息错误错误"; exit(); return null; } } 关于访问结果错误 {"errcode":42001,"errmsg":"access\_token expired"} 是因为你的好不是服务好无权限获取用户信息。 参考： http://mp.weixin.qq.com/wiki/index.php?title=%E9%A6%96%E9%A1%B5